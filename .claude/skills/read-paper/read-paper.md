---
name: read-paper
description: "研究型论文阅读助手：以五阶段渐进式流程分析学术论文 PDF"
license: Apache-2.0
---

## 用户意图配置

**首次使用检测**：检查项目根目录是否存在 `.claude/read-paper-intent.txt`。

- **若不存在**：使用 AskUserQuestion 工具询问用户阅读意图，提供以下选项：
  - **工程落地**：关注实现难度、部署成本、基础假设可行性、实际效果、技术趋势
  - **技术调研**：关注技术趋势、方法对比、应用场景、未来1年内的发展潜力

  询问后，将用户选择写入 `.claude/read-paper-intent.txt`（内容为 `engineering` 或 `research`），后续自动应用。

- **若存在**：读取文件内容，自动应用已保存的意图。用户可通过修改该文件或删除后重新运行来更改偏好。

## 输入处理与初始化

用户通过 `/read-paper <PDF路径>` 调用本 Skill。收到调用后，按以下步骤初始化：

1. **解析 PDF 路径并预处理**：
   - 从 `$ARGUMENTS` 提取 PDF 文件路径
   - 使用 Bash 工具检查 PDF 文件是否存在：`test -f "{PDF路径}" && echo "exists" || echo "not found"`
   - **文件不存在**：立即告知用户路径错误，要求重新提供有效的 PDF 文件路径，不继续后续步骤

   **使用 Docling 解析 PDF（缓存优先策略）**：
   - 生成缓存文件路径：`{PDF路径}.parsed.md`
   - 检查缓存是否存在且新于 PDF：
     ```bash
     if [ -f "{缓存路径}" ] && [ "{缓存路径}" -nt "{PDF路径}" ]; then
       echo "使用缓存"
     else
       echo "需要解析"
     fi
     ```
   - **如果缓存有效**：直接使用缓存，跳到步骤 2
   - **如果需要解析**：
     - 显示提示："正在使用 Docling 解析 PDF（首次解析约需 2 分钟，请稍候）..."
     - 调用解析脚本：`python scripts/pdf_parser.py "{PDF路径}" "{缓存路径}"`
     - 如果解析失败，告知用户："Docling 解析失败，请检查：(1) PDF 文件是否完整 (2) Docling 是否已安装（pip install docling）"，不继续后续步骤
     - 解析成功后，显示："PDF 解析完成，开始分析..."

   **错误处理**：
   - **Docling 未安装**：提示用户运行 `pip install docling` 安装依赖
   - **解析超时或失败**：检查 PDF 是否损坏，或文件过大（>100MB）
   - **缓存损坏**：删除缓存文件，重新解析

2. **从解析结果提取元数据**：
   - 使用 Read 工具读取缓存文件（`{缓存路径}`）的前 50 行
   - 从 Markdown 内容中提取论文标题（通常在前几行的 `##` 标题中）
   - 从 PDF 文件名提取 arXiv 编号（如 `2602.02660v1`）
   - 从 arXiv 编号提取年份（如 `2602` → `2026`）
   - 生成论文标题缩写（取标题前 1-2 个关键词，如 "MARS"）
   - 创建文件夹：`papers/{年份}/{论文标题缩写}-{arXiv编号}/`
   - 示例：`papers/2026/MARS-2602.02660v1/`

3. **移动文件到分类目录**：
   - 使用 Bash 工具将 PDF 和缓存文件移动到目标文件夹：
     ```bash
     mv "{原PDF路径}" "{目标文件夹}/"
     mv "{缓存路径}" "{目标文件夹}/"
     ```
   - 更新后续所有路径引用为新位置
   - 若移动失败（如文件已存在），使用 `cp` 复制而非移动，并在完成提示中说明

4. **派生笔记文件路径**：
   - `reading-notes.md`：存放 Phase 0-3 的阅读笔记
   - `research-insights.md`：存放 Phase 4 的研究者总结
   - 两个文件均位于论文文件夹内

5. **检测已有笔记**：检查 `reading-notes.md` 是否已存在。若已存在，后续 Phase 0 写入时需追加而非覆盖（在文件末尾添加 `---` 分隔线和当前日期后再写入新内容）。

6. **估算内容长度**：使用 Bash 工具统计缓存文件行数：`wc -l "{缓存路径}"`，用于后续阶段规划读取范围。

7. **跳过 References**：在整个阅读流程中，不读取也不分析论文的 References / Bibliography 部分。

初始化完成后，立即进入 Phase 0。

## Phase 0：阅读视角（~50 字）

**读取范围**：使用 Read 工具读取解析后的 Markdown 文件（`{缓存路径}`）前 200 行，覆盖 Title、Abstract、Introduction 和 Conclusion 部分。

**分析任务**：基于标题、摘要、引言和结论，推断：
- 该论文的核心研究目标是什么
- 你作为读者的阅读目的最可能属于哪一类（综述、批判、复现、启发——仅作为参考词汇辅助定位视角，不影响后续分析行为）

**输出**：用不超过 100 字写一段阅读视角说明，概括你将以什么视角、带着什么问题来阅读这篇论文。

**写入笔记文件**：
- 若 `reading-notes.md` 不存在：使用 Write 工具创建文件，写入 Phase 0 输出。
- 若 `reading-notes.md` 已存在：使用 Edit 工具在文件末尾追加 `---` 分隔线、当前日期、然后写入 Phase 0 输出。

Phase 0 完成后，不等待用户确认，直接继续执行 Phase 1（Phase 0 和 Phase 1 属于同一轮"第一遍阅读"）。
- 若笔记文件已存在：使用 Edit 工具在文件末尾追加 `---` 分隔线、当前日期、然后写入 Phase 0 输出。

Phase 0 完成后，不等待用户确认，直接继续执行 Phase 1（Phase 0 和 Phase 1 属于同一轮"第一遍阅读"）。

## Phase 1：快速筛选（~250 字）

**读取范围**：不额外读取。复用 Phase 0 已读取的 Markdown 内容（Title、Abstract、Introduction、Conclusion）。

**分析任务**：回答以下四个核心问题：
1. **研究问题**：这篇论文试图解决什么问题？
2. **重要性**：为什么这个问题重要？它在领域中的位置如何？
3. **主要贡献**：论文声称的核心贡献是什么？（列出 2-3 点）
4. **新意**：相比已有工作，新在哪里？是方法创新、应用创新还是视角创新？

**值得继续判断**：根据用户意图（从 `.claude/read-paper-intent.txt` 读取）选择对应的判断标准。

### 工程落地视角判断标准

✅ **值得深入阅读**（满足以下 3+ 条）：
1. **基础假设成立**：核心假设在实际场景中成立，不依赖易被绕过的机制
2. **实现复杂度低**：依赖少，可直接集成到现有系统，无需重构架构
3. **成本收益合理**：性能提升显著且成本可控（延迟、资源、API 调用成本等）
4. **技术细节充分**：有开源实现或技术细节充分，可快速验证
5. **解决真实痛点**：解决的是实际工程问题，而非纯理论问题
6. **技术趋势性**：代表未来 1 年内可能流行的技术方向

⚠️ **有条件值得**（部分满足但存在疑虑）：
- 方法有价值但实现成本高，需评估 ROI
- 依赖外部服务但可替换为本地方案
- 技术新颖但缺少生产验证

❌ **不建议继续**（满足以下任一条）：

**一级致命问题**（直接不可行）：
1. **基础假设不成立**：依赖易被绕过的机制（如提示词防御但攻击者绕过提示词）、假设不符合实际场景
2. **数据依赖不现实**：需要大量难以获取的标注数据或特定数据分布
3. **黑盒依赖无法控制**：严重依赖闭源模型或商业 API，无法自主部署
4. **引入新的安全/隐私风险**：方法本身成为新的攻击面或隐私泄露点

**二级问题**（可行但不值得）：
5. **成本收益严重失衡**：性能提升微小（如准确率 +0.5%）但成本显著增加（如延迟 +200%）
6. **可扩展性差**：无法扩展到生产规模（算法复杂度 O(n²)、内存占用线性增长等）
7. **技术债务极高**：需要重构现有架构，维护成本和风险极高

**三级问题**（实践困难）：
8. **理论与实践严重脱节**：理想条件下有效，实际场景假设不成立（如假设 i.i.d. 数据但存在分布漂移）
9. **环境依赖过强**：依赖特定硬件/软件版本，部署和维护困难
10. **可解释性差且关键**：黑盒方法在需要可解释性的关键业务中不可接受

**关键风险提示**（标记为 ❌ 时必须输出）：指出最核心的 1-2 个工程风险，例如："基础假设不成立：IRS 依赖提示词防御，但攻击者本就是绕过提示词的，安全性无法保证"。

### 技术调研视角判断标准

✅ **值得深入阅读**（满足以下 3+ 条）：
1. **技术趋势性**：方法代表未来 1 年内可能流行的技术方向
2. **通用性强**：在多个应用场景中具有通用性，不局限于特定任务
3. **对比优势明确**：与现有技术栈有明确的对比优势
4. **生态支持**：有工业界或开源社区的采用迹象
5. **方法论可迁移**：设计思路可迁移到其他问题域

⚠️ **有条件值得**：
- 技术新颖但成熟度不足，需持续关注
- 适用场景有限但在特定领域有价值

❌ **不建议继续**：
1. **技术路线过时**：已被证明不可行或被更优方案替代
2. **理想条件依赖**：仅在理想条件下有效，实际场景难以复现
3. **与趋势背离**：与当前技术趋势背离，缺少生态支持

**字数约束**：Phase 1 总结控制在 150-300 字之间。

**信息不足处理**：若论文文本不完整（如仅有摘要），基于可用信息给出分析，并明确标注哪些判断因信息不足而受限。

**写入笔记文件**：使用 Edit 工具将 Phase 1 分析结果追加到 `reading-notes.md` 末尾。

**阶段确认**：输出分析结果后，必须以"是否继续进入第二遍阅读？"结尾，等待用户回复。即使判断为 ❌ 不建议继续，若用户仍要求继续，尊重用户选择，进入 Phase 2，但笔记中保留原始的 ❌ 判断不修改。

## Phase 2：方法与结构拆解（~300 字）

**读取范围**：使用 Read 工具读取解析后的 Markdown 文件的 Methodology 和 Results/Experiments 章节。根据 Markdown 的章节标题（`##` 开头）定位相应内容，使用 `offset` 和 `limit` 参数读取。跳过 References 部分。

**分析任务**：对论文进行结构化拆解：
1. **问题→方法→证据→结论**：完整梳理论文的逻辑链条
2. **研究方法合理性评估**：所选方法是否适合研究问题？有无更优替代方案？
3. **假设与变量分析**：论文的核心假设是什么？自变量、因变量、控制变量是否清晰？
4. **实验设计完整性**：样本量、对照组、统计方法是否充分？
5. **关键图表作用**：指出最重要的 2-3 个图表及其在论证中的角色

**纯理论论文适配**：若论文属于纯理论或数学证明类（无实验设计），将上述第 4 点"实验设计完整性"替换为"证明路径分析"——评估定理陈述、证明策略、关键引理的逻辑完整性。

**字数约束**：Phase 2 输出控制在约 300 字。

**写入笔记文件**：使用 Edit 工具将 Phase 2 分析结果追加到 `reading-notes.md` 末尾。

**阶段确认**：输出分析结果后，必须以"是否继续进入第三遍阅读？"结尾，等待用户回复。

## Phase 3：论证可靠性评估（~250 字）

**读取范围**：使用 Read 工具读取解析后的 Markdown 文件的 Discussion 章节和核心论证段落。根据 Phase 2 中已了解的论文结构定位相应内容。跳过 References 部分。

**分析任务**：使用 Toulmin 论证模型对论文的每个核心主张进行系统性评估：

对每个核心主张，分析以下四要素：
- **Claim（主张）**：论文提出的核心结论或断言是什么？
- **Data（数据/证据）**：支撑该主张的具体证据是什么？
- **Warrant（推论依据）**：从证据到结论的推理逻辑是什么？这个推理是否成立？
- **Rebuttal（反驳/限制）**：在什么条件下该主张可能不成立？论文是否承认了这些限制？

**结论强弱评级**：对每个主张给出强弱评级，标注：
- 逻辑跳跃（证据不足以支撑结论的地方）
- 证据不足（缺少关键实验或数据的地方）
- 论证有力（证据充分、推理严密的地方）

**多主张处理**：若论文包含多个独立主张，分别对每个主张进行独立的 Toulmin 分析，不要合并。

**字数约束**：Phase 3 输出控制在约 250 字。

**写入笔记文件**：使用 Edit 工具将 Phase 3 分析结果追加到 `reading-notes.md` 末尾。

**阶段确认**：输出分析结果后，必须以"是否进入研究者总结？"结尾，等待用户回复。

## Phase 4：研究者总结（~650 字）

**读取范围**：不额外读取。综合 Phase 0-3 中已读取和分析的所有 Markdown 内容进行总结。

**分析任务**：站在读者自身研究的角度，将论文转化为可复用的研究资产：

1. **研究启发**：这篇论文对你自身的研究有哪些启发？可以从问题定义、方法选择、实验设计、理论框架等角度展开。
2. **可改进与可扩展方向**：基于论文的局限性和未解决的问题，指出 2-3 个具体的改进或扩展方向，说明为什么这些方向有价值。
3. **引用/复现/进一步研究建议**：给出明确建议——
   - 是否值得在自己的论文中引用？引用哪些具体观点或结果？
   - 是否值得复现其实验或方法？复现的关键挑战是什么？
   - 是否值得基于此论文开展进一步研究？具体方向是什么？

**字数约束**：Phase 4 输出控制在约 650 字。这是将论文转化为可复用研究资产的关键阶段，获得额外的深度空间。整篇笔记总字数目标约 1500 字（Phase 0-3 约 850 字 + Phase 4 约 650 字）。

**写入笔记文件**：使用 Write 工具将 Phase 4 分析结果写入 `research-insights.md`。若文件已存在，使用 Edit 工具在文件末尾追加 `---` 分隔线、当前日期、然后写入新内容。

**完成提示**：输出"阅读完成。笔记已保存至：\n- 阅读笔记：`<reading-notes.md路径>`\n- 研究总结：`<research-insights.md路径>`\n- PDF 文件：`<PDF最终路径>`"，其中路径替换为实际的文件路径。不再询问是否继续，阅读流程到此结束。

## 跨阶段规则

以下规则在所有阶段中始终生效：

### 阶段流转控制

- 严格按 Phase 0 → Phase 1 → Phase 2 → Phase 3 → Phase 4 顺序执行，不可跳过任何阶段。
- 若用户请求跳到后续阶段（如直接要求 Phase 3），拒绝并说明需按顺序完成前置阶段。
- 每个阶段完成后，必须等待用户明确确认才进入下一阶段。**例外**：Phase 0 和 Phase 1 作为"第一遍阅读"连续执行，Phase 0 完成后直接进入 Phase 1，无需等待用户确认。
- 若用户回复"不继续"、"停止"、"结束"或类似表达，结束阅读会话。已写入笔记文件的内容保留不删除。
- 若用户在中途要求更换论文，重置所有状态，从新论文的 Phase 0 重新开始。

### 语言与语体

- 使用研究者语言（学术语体），而非通俗科普风格。假设读者具备学术研究背景。
- 输出语言与用户交互语言保持一致：用户用中文提问则中文输出，用英文则英文输出。
- 若论文为非中英文语言，以用户交互语言输出分析，关键术语保留原语言并附标注。

### 客观性与引用

- 所有评价性判断必须引用论文原文（直接引用或标注章节/页码）作为依据。
- 明确区分论文原文的客观陈述与你自身的分析评价。不得将主观判断伪装为论文结论。
- 使用"论文指出……"、"作者认为……"标记原文观点；使用"分析认为……"、"值得注意的是……"标记你的评价。

### 内容聚焦

- 聚焦核心观点，省略详细实验数据表格和冗余细节，仅保留对理解论文贡献有价值的关键数据。
- 笔记内部采用自由格式，根据论文特点自适应组织内容结构，不强制固定章节模板。

### 意图配置文件管理

- **配置文件位置**：`.claude/read-paper-intent.txt`
- **配置文件内容**：`engineering`（工程落地）或 `research`（技术调研）
- **修改偏好**：用户可直接编辑该文件或删除后重新运行 `/read-paper` 来更改阅读意图
- **首次使用**：若配置文件不存在，skill 会在初始化阶段使用 AskUserQuestion 工具询问用户意图并自动创建配置文件
